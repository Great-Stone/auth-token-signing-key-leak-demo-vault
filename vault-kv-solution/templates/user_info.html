<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ìš©ì ì •ë³´</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1976d2;
        }
        .user-info {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .info-row {
            display: flex;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .info-label {
            font-weight: bold;
            width: 150px;
        }
        .info-value {
            flex: 1;
        }
        .token-info {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 12px;
            word-break: break-all;
        }
        .warning {
            background-color: #ffebee;
            border: 1px solid #d32f2f;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #1976d2;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            margin: 10px 5px;
        }
        .code-block {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        .diagram-container {
            display: flex;
            gap: 20px;
            margin: 30px 0;
        }
        .diagram {
            flex: 1;
            background-color: #f9f9f9;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
        }
        .diagram h3 {
            margin-top: 0;
            color: #1976d2;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 10px;
        }
        .flow-box {
            background-color: white;
            border: 2px solid #4caf50;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
        }
        .flow-box.vault {
            border-color: #ff9800;
            background-color: #fff3e0;
        }
        .flow-box.app {
            border-color: #2196f3;
            background-color: #e3f2fd;
        }
        .flow-box::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid #4caf50;
        }
        .flow-box.vault::before {
            border-right-color: #ff9800;
        }
        .flow-box.app::before {
            border-right-color: #2196f3;
        }
        .flow-box:first-child::before {
            display: none;
        }
        .flow-arrow {
            text-align: center;
            font-size: 24px;
            color: #666;
            margin: 5px 0;
        }
        .flow-label {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .flow-detail {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ì‚¬ìš©ì ì •ë³´</h1>
        
        <div class="user-info">
            <div class="info-row">
                <div class="info-label">ID:</div>
                <div class="info-value">{{ user.id }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">ì‚¬ìš©ìëª…:</div>
                <div class="info-value">{{ user.username }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">ì´ë©”ì¼:</div>
                <div class="info-value">{{ user.email }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">ì „í™”ë²ˆí˜¸:</div>
                <div class="info-value">{{ user.phone_num }}</div>
            </div>
            <div class="info-row">
                <div class="info-label">ì£¼ì†Œ:</div>
                <div class="info-value">{{ user.address }}</div>
            </div>
        </div>
        
        <div class="success" style="background-color: #e8f5e9; border: 1px solid #4caf50; padding: 15px; border-radius: 4px; margin: 20px 0;">
            <strong>âœ… ê°œì„  ì‚¬í•­:</strong> 
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>ì„œëª… í‚¤ê°€ Vault KVì— ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤</li>
                <li>í† í°ì˜ user_idì™€ ìš”ì²­í•œ user_idë¥¼ ë¹„êµí•˜ì—¬ ê²€ì¦í•©ë‹ˆë‹¤</li>
                <li>í‚¤ê°€ ì•± ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì§€ ì•Šì•„ ìœ ì¶œ ìœ„í—˜ì´ ì¤„ì–´ë“­ë‹ˆë‹¤</li>
            </ul>
        </div>
        
        <div class="diagram-container">
            <div class="diagram">
                <h3>ğŸ” í† í° ìƒì„± íë¦„ (ë¡œê·¸ì¸ ì‹œ)</h3>
                <div class="flow-box app">
                    <div class="flow-label">1. ì•±: ì‚¬ìš©ì ì¸ì¦</div>
                    <div class="flow-detail">ì‚¬ìš©ìëª…/ë¹„ë°€ë²ˆí˜¸ ê²€ì¦</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box vault">
                    <div class="flow-label">2. Vault KV: ê°œì¸í‚¤ ì¡°íšŒ</div>
                    <div class="flow-detail">API í˜¸ì¶œ: GET /v1/secret/data/jwt-signing-key</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box app">
                    <div class="flow-label">3. ì•±: í† í° ìƒì„± ë° ì„œëª…</div>
                    <div class="flow-detail">ê°œì¸í‚¤ë¡œ JWT í† í° ì„œëª… (RS256)</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box app">
                    <div class="flow-label">4. ì•±: í† í° ë°˜í™˜</div>
                    <div class="flow-detail">ì„œëª…ëœ í† í°ì„ ì„¸ì…˜ì— ì €ì¥</div>
                </div>
            </div>
            
            <div class="diagram">
                <h3>âœ… í† í° ê²€ì¦ íë¦„ (í˜ì´ì§€ ì ‘ê·¼ ì‹œ)</h3>
                <div class="flow-box app">
                    <div class="flow-label">1. ì•±: í† í° ìˆ˜ì‹ </div>
                    <div class="flow-detail">ì„¸ì…˜ ë˜ëŠ” í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box vault">
                    <div class="flow-label">2. Vault KV: ê³µê°œí‚¤ ì¡°íšŒ</div>
                    <div class="flow-detail">API í˜¸ì¶œ: GET /v1/secret/data/jwt-signing-key</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box app">
                    <div class="flow-label">3. ì•±: í† í° ê²€ì¦</div>
                    <div class="flow-detail">ê³µê°œí‚¤ë¡œ ì„œëª… ê²€ì¦ (RS256)</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box app">
                    <div class="flow-label">4. ì•±: user_id ê²€ì¦</div>
                    <div class="flow-detail">í† í°ì˜ user_idì™€ ìš”ì²­ user_id ë¹„êµ</div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-box app">
                    <div class="flow-label">5. ì•±: ì‚¬ìš©ì ì •ë³´ ë°˜í™˜</div>
                    <div class="flow-detail">ê²€ì¦ ì„±ê³µ ì‹œ ì‚¬ìš©ì ì •ë³´ í‘œì‹œ</div>
                </div>
            </div>
        </div>
        
        <div style="background-color: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 4px;">
            <strong>ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸:</strong>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>Vault KV ì—­í• :</strong> í‚¤ ì €ì¥ ë° ì œê³µ (ê°œì¸í‚¤/ê³µê°œí‚¤)</li>
                <li><strong>ì•± ì—­í• :</strong> í‚¤ë¥¼ ë¡œë“œí•˜ì—¬ í† í° ìƒì„±/ê²€ì¦ ìˆ˜í–‰</li>
                <li><strong>ë³´ì•ˆ ê°œì„ :</strong> í‚¤ê°€ ì•± ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì§€ ì•ŠìŒ, Vaultì—ì„œ ë™ì  ë¡œë“œ</li>
            </ul>
        </div>
        
        <div class="token-info">
            <strong>í˜„ì¬ í† í°:</strong><br>
            <div class="code-block">{{ current_token }}</div>
            <br>
            <strong>í† í° Payload:</strong><br>
            <pre>{{ token_info | tojson(indent=2) }}</pre>
        </div>
        
        <a href="/" class="btn">í™ˆìœ¼ë¡œ</a>
    </div>
</body>
</html>

